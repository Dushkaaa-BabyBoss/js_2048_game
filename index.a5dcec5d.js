!function(){var e=new(function(){var e;function t(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.defaultState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.board=e||JSON.parse(JSON.stringify(this.defaultState)),this.score=0,this.status="idle"}return e=[{key:"arraysEqual",value:function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}},{key:"moveLeft",value:function(){for(var e=this,t=!1,r=0;r<4;r++)!function(r){for(var a=e.board[r].filter(function(e){return 0!==e}),n=0;n<a.length-1;n++)a[n]===a[n+1]&&(a[n]*=2,e.score+=a[n],a[n+1]=0,t=!0);for(a=a.filter(function(e){return 0!==e});a.length<4;)a.push(0);e.arraysEqual(e.board[r],a)||(t=!0),e.board[r]=a}(r);"playing"===this.status&&t&&this.addRandomTile()}},{key:"moveRight",value:function(){for(var e=this,t=!1,r=0;r<4;r++)!function(r){for(var a=e.board[r].slice().reverse().filter(function(e){return 0!==e}),n=0;n<a.length-1;n++)a[n]===a[n+1]&&(a[n]*=2,e.score+=a[n],a[n+1]=0,t=!0);for(a=a.filter(function(e){return 0!==e});a.length<4;)a.push(0);a.reverse(),e.arraysEqual(e.board[r],a)||(t=!0),e.board[r]=a}(r);"playing"===this.status&&t&&this.addRandomTile()}},{key:"moveUp",value:function(){for(var e=this,t=function(t){for(var a=[],n=0;n<4;n++)0!==e.board[n][t]&&a.push(e.board[n][t]);for(var o=0;o<a.length;o++)a[o]===a[o+1]&&(a[o]*=2,e.score+=a[o],a[o+1]=0,r=!0);for(a=a.filter(function(e){return 0!==e});a.length<4;)a.push(0);e.arraysEqual(e.board.map(function(e){return e[t]}),a)||(r=!0);for(var i=0;i<4;i++)e.board[i][t]=a[i]},r=!1,a=0;a<4;a++)t(a);"playing"===this.status&&r&&this.addRandomTile()}},{key:"moveDown",value:function(){for(var e=this,t=!1,r=0;r<4;r++)!function(r){var a=[];a.reverse();for(var n=0;n<4;n++)0!==e.board[n][r]&&a.push(e.board[n][r]);for(var o=0;o<a.length;o++)a[o]===a[o+1]&&(a[o]*=2,e.score+=a[o],a[o+1]=0,t=!0);for((a=a.filter(function(e){return 0!==e})).reverse();a.length<4;)a.push(0);for(var i=0;i<4;i++)e.board[i][r]=a[3-i]}(r);"playing"===this.status&&t&&this.addRandomTile()}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return"idle"===this.status?"idle":this.checkWin()?"win":this.checkLose()?"lose":"playing"}},{key:"checkWin",value:function(){return this.board.some(function(e){return e.includes(2048)})}},{key:"checkLose",value:function(){if(this.board.some(function(e){return e.includes(0)}))return!1;for(var e=0;e<4;e++)for(var t=0;t<4;t++)if(t<3&&this.board[e][t]===this.board[e][t+1]||e<3&&this.board[e][t]===this.board[e+1][t])return!1;return!0}},{key:"start",value:function(){this.board=JSON.parse(JSON.stringify(this.defaultState)),this.score=0,this.status="playing",this.addRandomTile(),this.addRandomTile()}},{key:"addRandomTile",value:function(){for(var e=[],t=0;t<4;t++)for(var r=0;r<4;r++)0===this.board[t][r]&&e.push({row:t,col:r});if(e.length>0){var a=e[Math.floor(Math.random()*e.length)],n=a.row,o=a.col;this.board[n][o]=.9>Math.random()?2:4}}},{key:"restart",value:function(){return this.start()}}],function(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(t.prototype,e),t}());function t(){var t,r,a,n,o=e.getState();document.querySelectorAll(".field-row").forEach(function(e,t){e.querySelectorAll(".field-cell").forEach(function(e,r){var a=o[t][r];e.textContent=0===a?"":a,e.className="field-cell",0!==a&&e.classList.add("field-cell--".concat(a))})}),document.querySelector(".game-score").textContent=e.getScore(),t=e.getStatus(),r=document.querySelector(".message-start"),a=document.querySelector(".message-win"),n=document.querySelector(".message-lose"),r.classList.add("hidden"),a.classList.add("hidden"),n.classList.add("hidden"),"idle"===t?r.classList.remove("hidden"):"win"===t?a.classList.remove("hidden"):"lose"===t&&n.classList.remove("hidden")}document.addEventListener("keydown",function(r){switch(r.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight();break;default:return 0}t()});var r=document.querySelector(".start");r.addEventListener("click",function(){r.classList.contains("start")&&(r.classList.replace("start","restart"),r.textContent="Restart"),e.start(),t()})}();
//# sourceMappingURL=index.a5dcec5d.js.map
